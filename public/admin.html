<!DOCTYPE html>
<html lang="uz">
<head>
<meta charset="utf-8">
<title>Ibodulla.official ‚Äî Admin / Tokens</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta name="robots" content="noindex">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
<style>
:root{--green:#2e7d32;--dark:#233;--muted:#666;--bg:#f5f6fa;--card:#fff;--accent:#1b5e20;}
*{box-sizing:border-box}html,body{height:100%;margin:0;font-family:"Segoe UI",Roboto,Arial,sans-serif;background:var(--bg);color:var(--dark);}
a{color:inherit;text-decoration:none}button{font-family:inherit}.app-shell{display:flex;min-height:100vh;align-items:stretch;}
.sidebar{width:240px;background:var(--card);padding:18px;border-right:1px solid rgba(0,0,0,0.04);position:fixed;left:0;top:0;bottom:0;overflow:auto;box-shadow:2px 0 8px rgba(0,0,0,0.04);transition:transform .28s ease;z-index:1200;}
.sidebar h2{text-align:center;color:var(--green);margin:2px 0 14px;font-size:18px}
.group-list a, .main-menu a{display:block;padding:10px 12px;border-radius:8px;margin:6px 0;color:#333;cursor:pointer}
.group-list a:hover,.main-menu a:hover{background:var(--green);color:white}
.group-list a.active{background:var(--green);color:white}
.sidebar .small{font-size:13px;color:var(--muted);margin-top:6px;text-align:center}
.main{margin-left:240px;flex:1;padding:18px 20px 120px;transition:margin-left .28s ease;}
header.top{display:flex;align-items:center;justify-content:space-between;background:var(--card);padding:12px 16px;border-radius:10px;box-shadow:0 2px 6px rgba(0,0,0,0.06)}
header h1{margin:0;color:var(--green);font-size:18px}
.grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:18px;margin:18px 0}
.card{background:var(--card);padding:14px;border-radius:10px;box-shadow:0 2px 8px rgba(0,0,0,0.04)}
.card h3{margin:0 0 10px;color:#333;font-size:15px}
.highlight{font-size:20px;font-weight:700;color:var(--green)}
table{width:100%;border-collapse:collapse;background:var(--card);border-radius:10px;overflow:hidden;box-shadow:0 2px 6px rgba(0,0,0,0.04)}
th,td{padding:10px;text-align:left;border-bottom:1px solid #f0f0f0}
th{background:#fafafa;color:var(--muted);font-weight:600}
td.center{text-align:center}
.btn{padding:8px 10px;border-radius:8px;border:0;cursor:pointer}
.btn-primary{background:var(--green);color:white}
.btn-danger{background:#c62828;color:white}
.choice{display:inline-block;padding:6px 10px;border-radius:20px;border:1px solid #e0e0e0;background:#f7f7f7;cursor:pointer}
.choice.active{background:var(--green);color:white;border-color:var(--green)}
input[type="text"],input[type="number"],input[type="password"],select{width:100%;padding:8px;border-radius:8px;border:1px solid #ddd;margin:6px 0;box-sizing:border-box;}
.footer-marquee{position:fixed;left:0;right:0;bottom:0;background:var(--accent);color:white;padding:10px;text-align:left;font-weight:600;z-index:1100}
@media(max-width:900px){.sidebar{transform:translateX(-100%)}.sidebar.open{transform:translateX(0)}.main{margin-left:0}}
.muted{color:var(--muted);font-size:13px}
.tiny{font-size:12px;color:#888}
</style>
</head>
<body>
<div class="app-shell">
<aside class="sidebar" id="sidebar" aria-label="left sidebar">
<h2>Ibodulla.official</h2>
<div class="main-menu">
<a id="navAdmin">‚öôÔ∏è Admin</a>
<a id="navTokens">üîê Tokens</a>
</div>
<hr style="border:none;height:8px">
<div class="muted" style="text-align:center">Guruhlar</div>
<div class="group-list" id="groupList"></div>
<div class="sidebar-footer small"><div style="margin-top:12px">¬© Ibodulla.official</div></div>
</aside>
<main class="main" id="main">
<header class="top">
<h1 id="pageTitle">Admin ‚Äî Guruh 1</h1>
</header>
<div id="pageContent"></div>
</main>
</div>
<div class="footer-marquee">
<i class="fab fa-instagram" style="color:#e1306c;margin-right:8px"></i> education_of_ibodulla ‚ú®
</div>
<script>
const groups=[{id:0,name:"1-guruh",time:"08:00-10:00"},{id:1,name:"2-guruh",time:"10:00-12:00"},{id:2,name:"3-guruh",time:"14:00-16:00"},{id:3,name:"4-guruh",time:"16:00-18:00"}];
let students=JSON.parse(localStorage.getItem('eoib_students')||'[]');
if(!students.length){
students=[{id:"s0",name:"Humoyun Abdumominov",phone:"+998901112200",group:0,token:"token0"},{id:"s1",name:"Abdulatif Anorov",phone:"+998901112201",group:0,token:"token1"}];
localStorage.setItem('eoib_students',JSON.stringify(students));
}
function getCoinMap(){return JSON.parse(localStorage.getItem('eoib_coins')||'{}');}
function setCoinMap(obj){localStorage.setItem('eoib_coins',JSON.stringify(obj));}
let coinMap=getCoinMap();
const pageContent=document.getElementById('pageContent'),pageTitle=document.getElementById('pageTitle'),groupListEl=document.getElementById('groupList');
function renderGroupList(){groupListEl.innerHTML='';groups.forEach(g=>{const a=document.createElement('a');a.textContent=`${g.name} (${g.time})`;a.dataset.group=g.id;a.onclick=()=>renderAdmin(g.id);groupListEl.appendChild(a);});}renderGroupList();
function toast(msg){const el=document.createElement('div');el.textContent=msg;el.style.position='fixed';el.style.right='16px';el.style.bottom='80px';el.style.background='rgba(0,0,0,0.8)';el.style.color='white';el.style.padding='10px 14px';el.style.borderRadius='8px';el.style.zIndex=9999;document.body.appendChild(el);setTimeout(()=>el.remove(),2200);}
function navigateTo(route){if(route==='admin')renderAdmin();else if(route==='tokens')renderTokens();}
document.getElementById('navAdmin').onclick=()=>navigateTo('admin');document.getElementById('navTokens').onclick=()=>navigateTo('tokens');

function renderAdmin(groupId=0){
pageTitle.innerText=`${groups[groupId].name} ‚Äî Admin`;
let html='<div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:12px">';
html+=`<div style="flex:1;min-width:240px" class="card">
<h3>Guruh: ${groups[groupId].name} <span class="tiny">(${groups[groupId].time})</span></h3>
<p class="muted">Bu panel orqali o'quvchilarni boshqarishingiz mumkin.</p>
<div style="margin-top:8px">
<label class="tiny">Yangi o‚Äòquvchi qo‚Äòshish</label>
<input type="text" id="newStudentName" placeholder="Ism Familiya"/>
<button class="btn btn-primary" id="createStudentBtn">+ Qo‚Äòsh</button>
</div>
</div></div>`;
html+='<div style="margin-top:14px" class="card"><h3>O‚Äòquvchilar ro‚Äòyxati</h3><table><thead><tr><th>#</th><th>Ism</th><th>Token</th><th>Link</th><th>Amal</th></tr></thead><tbody id="adminStudentsTbody">';
students.filter(s=>s.group===groupId).forEach((s,i)=>{const link=`${location.origin}${location.pathname}#parent?token=${encodeURIComponent(s.token)}`;html+=`<tr id="row-${s.id}"><td>${i+1}</td><td>${s.name}</td><td>${s.token}</td><td><a href="${link}" target="_blank">${link}</a></td><td><button class="btn" data-delete="${s.id}">O‚Äòchirish</button></td></tr>`;});
html+='</tbody></table></div>';
pageContent.innerHTML=html;
document.getElementById('createStudentBtn').onclick=()=>{
const name=document.getElementById('newStudentName').value.trim();
if(!name){toast('Ism kiriting');return;}
const id='s'+(Math.floor(Math.random()*90000)+Date.now()%1000);
const token='t'+Math.random().toString(36).slice(2,9);
students.push({id,name,phone:'+9989'+Math.floor(1000000+Math.random()*8999999),group:groupId,token});
localStorage.setItem('eoib_students',JSON.stringify(students));
coinMap[id]=0;setCoinMap(coinMap);
document.getElementById('newStudentName').value='';renderAdmin(groupId);
toast('Yangi o‚Äòquvchi yaratildi');
};
document.querySelectorAll('button[data-delete]').forEach(b=>{b.onclick=()=>{const id=b.dataset.delete;students=students.filter(x=>x.id!==id);localStorage.setItem('eoib_students',JSON.stringify(students));delete coinMap[id];setCoinMap(coinMap);renderAdmin(groupId);toast('O‚Äòquvchi o‚Äòchirildi');};});
}

function renderTokens(){
pageTitle.innerText='Tokens';
pageContent.innerHTML='<div class="card" style="max-width:900px"><h3>Tokenlar va linklar</h3><table><thead><tr><th>#</th><th>Ism</th><th>Token</th><th>Link</th><th>Amal</th></tr></thead><tbody id="tokensTbody"></tbody></table></div>';
const tbody=document.getElementById('tokensTbody');tbody.innerHTML='';
students.forEach((s,i)=>{const link=`${location.origin}${location.pathname}#parent?token=${encodeURIComponent(s.token)}`;const tr=document.createElement('tr');tr.innerHTML=`<td>${i+1}</td><td>${s.name}</td><td>${s.token}</td><td><a href="${link}" target="_blank">${link}</a></td><td><button class="btn" data-copy="${link}">Copy</button></td>`;tbody.appendChild(tr);});
tbody.querySelectorAll('button[data-copy]').forEach(b=>{b.onclick=()=>{navigator.clipboard.writeText(b.dataset.copy).then(()=>toast('Link nusxalandi'));};});
}

// initial nav
navigateTo('admin');
</script>
</body>
</html>
